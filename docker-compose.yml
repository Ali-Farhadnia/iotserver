version: '3'
services:
  iotserver:
    build:
      context: .    # Build the image from the current directory where the Dockerfile is located
      dockerfile: Dockerfile  # This is optional if the Dockerfile is named "Dockerfile"
    ports:
      - "9090:9090"
    volumes:
      - ./data:/app/data  # Persist the SQLite DB on the host
    restart: on-failure   # Restart on failure
  mosquitto:
    image: eclipse-mosquitto:latest
    ports:
      - "1883:1883"
      - "9001:9001"
    volumes:
      - ./mosquitto.conf:/mosquitto/config/mosquitto.conf
    restart: unless-stopped
